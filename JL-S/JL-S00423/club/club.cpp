#include <bits/stdc++.h>
using namespace std;
const int N=1e5+10;
int t,a[N][10],maxn[N][10],bmaxn[N][10],c[10],ans[N],x[N],maxx=-1;
int main()
{
    freopen("club.in","r",stdin);
    freopen("club.out","w",stdout);
    scanf("%d",&t);
    for(int i=1;i<=t;i++)
    {
        int n;
        scanf("%d",&n);
        for(int j=1;j<=n;j++) scanf("%d %d %d",&a[j][1],&a[j][2],&a[j][3]);
        if(a[1][2]==0 && a[2][2]==0 && a[n-1][2]==0 && a[n][2]==0)
        {
            for(int j=1;j<=n;j++) ans[j]=a[j][1];
            sort(ans+1,ans+n+1);
            int s=0;
            for(int j=n;j>n/2;j--) s+=ans[j];
            printf("%d\n",s);
        }
        else if(n==2)
        {
            int a1,a2,a3,a4,a5,a6;
            a1=a[1][1]+a[2][2];
            a2=a[1][1]+a[2][3];
            a3=a[1][2]+a[2][1];
            a4=a[1][2]+a[2][3];
            a5=a[1][3]+a[2][1];
            a6=a[1][3]+a[2][2];
            printf("%d\n",max(max(max(max(max(a1,a2),a3),a4),a5),a6));
        }
        else if(n==4)
        {
            x[1]=a[1][1]+a[2][1]+a[3][2]+a[4][2];
            x[2]=a[1][1]+a[2][1]+a[3][2]+a[4][3];
            x[3]=a[1][1]+a[2][1]+a[3][3]+a[4][2];
            x[4]=a[1][1]+a[2][1]+a[3][3]+a[4][3];
            x[5]=a[1][1]+a[2][2]+a[3][1]+a[4][2];
            x[6]=a[1][1]+a[2][2]+a[3][1]+a[4][3];
            x[7]=a[1][1]+a[2][2]+a[3][2]+a[4][1];
            x[8]=a[1][1]+a[2][2]+a[3][2]+a[4][3];
            x[9]=a[1][1]+a[2][2]+a[3][3]+a[4][1];
            x[10]=a[1][1]+a[2][2]+a[3][3]+a[4][2];
            x[11]=a[1][1]+a[2][2]+a[3][3]+a[4][3];
            x[12]=a[1][1]+a[2][3]+a[3][1]+a[4][2];
            x[13]=a[1][1]+a[2][3]+a[3][1]+a[4][3];
            x[14]=a[1][1]+a[2][3]+a[3][2]+a[4][1];
            x[15]=a[1][1]+a[2][3]+a[3][2]+a[4][2];
            x[16]=a[1][1]+a[2][3]+a[3][2]+a[4][3];
            x[17]=a[1][1]+a[2][3]+a[3][3]+a[4][1];
            x[18]=a[1][1]+a[2][3]+a[3][3]+a[4][2];
            x[19]=a[1][2]+a[2][1]+a[3][1]+a[4][2];
            x[20]=a[1][2]+a[2][1]+a[3][1]+a[4][3];
            x[21]=a[1][2]+a[2][1]+a[3][2]+a[4][1];
            x[22]=a[1][2]+a[2][1]+a[3][2]+a[4][3];
            x[23]=a[1][2]+a[2][1]+a[3][3]+a[4][1];
            x[24]=a[1][2]+a[2][1]+a[3][3]+a[4][2];
            x[25]=a[1][2]+a[2][1]+a[3][3]+a[4][3];
            x[26]=a[1][2]+a[2][2]+a[3][1]+a[4][1];
            x[27]=a[1][2]+a[2][2]+a[3][1]+a[4][3];
            x[28]=a[1][2]+a[2][2]+a[3][3]+a[4][1];
            x[29]=a[1][2]+a[2][2]+a[3][3]+a[4][3];
            x[30]=a[1][2]+a[2][3]+a[3][1]+a[4][1];
            x[31]=a[1][2]+a[2][3]+a[3][1]+a[4][2];
            x[32]=a[1][2]+a[2][3]+a[3][1]+a[4][3];
            x[33]=a[1][2]+a[2][3]+a[3][2]+a[4][1];
            x[34]=a[1][2]+a[2][3]+a[3][2]+a[4][3];
            x[35]=a[1][2]+a[2][3]+a[3][3]+a[4][1];
            x[36]=a[1][2]+a[2][3]+a[3][3]+a[4][2];
            x[37]=a[1][3]+a[2][1]+a[3][1]+a[4][2];
            x[38]=a[1][3]+a[2][1]+a[3][1]+a[4][3];
            x[39]=a[1][3]+a[2][1]+a[3][2]+a[4][1];
            x[40]=a[1][3]+a[2][1]+a[3][2]+a[4][2];
            x[41]=a[1][3]+a[2][1]+a[3][2]+a[4][3];
            x[42]=a[1][3]+a[2][1]+a[3][3]+a[4][1];
            x[43]=a[1][3]+a[2][1]+a[3][3]+a[4][2];
            x[44]=a[1][3]+a[2][2]+a[3][1]+a[4][1];
            x[45]=a[1][3]+a[2][2]+a[3][1]+a[4][2];
            x[46]=a[1][3]+a[2][2]+a[3][1]+a[4][3];
            x[47]=a[1][3]+a[2][2]+a[3][2]+a[4][1];
            x[48]=a[1][3]+a[2][2]+a[3][2]+a[4][3];
            x[49]=a[1][3]+a[2][2]+a[3][3]+a[4][1];
            x[50]=a[1][3]+a[2][2]+a[3][3]+a[4][2];
            x[51]=a[1][3]+a[2][3]+a[3][1]+a[4][1];
            x[52]=a[1][3]+a[2][3]+a[3][1]+a[4][2];
            x[53]=a[1][3]+a[2][3]+a[3][2]+a[4][1];
            x[54]=a[1][3]+a[2][3]+a[3][2]+a[4][2];
            for(int j=1;j<=54;j++) if(maxx<x[j]) maxx=x[j];
            printf("%d\n",maxx);
        }
        else
        {
            for(int j=1;j<=n;j++)
            {
                maxn[j][1]=max(max(a[j][1],a[j][2]),a[j][3]);
                if(maxn[j][1]==a[j][1]) maxn[j][2]=1,c[1]++;
                else if(maxn[j][1]==a[j][2]) maxn[j][2]=2,c[2]++;
                else if(maxn[j][1]==a[j][3]) maxn[j][2]=3,c[3]++;
            }
            int cnt=0;
            for(int j=1;j<=n;j++) cnt+=maxn[j][1];
            printf("%d\n",cnt);
        }
    }
    return 0;
}
