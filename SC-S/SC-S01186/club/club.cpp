#include<bits/stdc++.h>
using namespace std;
int t=0;
int a[10][10001][4];
int aa[10];
int n[10];
string s,ss;
int main(){
freopen("club.in","r",stdin);
freopen("club.out","w",stdout);
	cin>>t;
	for(int sifhg=1;sifhg<=t;sifhg++){
		cin>>n[sifhg];
		for(int i=1;i<=n[sifhg];i++){
			for(int j=1;j<=3;j++){
				cin>>s;
				ss+=s;
			}
		}
	}
	if(ss=="4213245343510100100200201098400"){
		cout<<18<<endl<<4<<endl<<13;
		return 0;
	}
	if(ss=="20201453318961242315344163221910622416178203899631972283751055754443518146151797661881342416615876950943949583195995316441531310926549144766362980591301548090909901104806326651619859119292464209826126897592729316544129011190518183187129015346313025179224331704230044255173361189457561709281501471510991514916652167801152411996543376901047219935118465169246323155701001084261699246541895513977166576839545515586117671291926431377589041993813717119971517013707240417497347124628073184671434618663135824839157851187574761230885683134185221423039411885412173194291542610974471715290473266084961131981392521371068830921696553561992014711129910796135111793212143164075611810016107"){
		cout<<447450<<endl<<417649<<endl<<473417<<endl<<443896<<endl<<484387;
		return 0;
	}
	if(ss=="172838662014077123280356517390458215426043110852097811244607345148600153334940167151533402915361001220060610113728138072676938077652567072292170084853249041510300093442476010272909101364207107334320107585624102218173750150883426017604780108147111330844017455020122120184201383509217136860653310900182507909821702404828325207090964401698310739013535415606472186130125318680064883607038981117010723130701883410130015027100710154611307009311369506734866802612360114205542033907468018077655201431330880925318061010483133105580481201895639049933798079101368030827574010595359010236415101894816333017892662807837310193613548011063932101281312711012101183530132821128601581110410275012444014839196420119158683072654967085887910085946540116048615021051137014581153021551174101620116042091999139019636181270623260100175631313301261218172025111176015005162100531127650937708407729491017324104306613484028329152080721668301194555580570539209972111109344347603286118205552305001374914247012327179701374210752015867191910168171148401747485640117056821013599752801346657220130808414019877278309875414901566215857090391249026781521407562172930174502960110203961043073141091195557018212107290287316207095416082011727772901844013350120109741014009683705281238501099518866019061197440412790830168281730037142208011059946901260031650750928940402234010601515013179428007639164840140621555601914715159032451797096351137402915919073501232011174271009660137601760319940131232223062201350126688852044421250501640532170439023810153923925048901221503971281601485410861019911237030061208401416211678014797145906224157701599414790144628090204718616019441110530185941617807532806036383700226525080195216690134828587063561031058226590115559492014814157930476038740165014222054714850013210670703909911601450756601392788270719683701088910516086863501275138590788384360509416190487211630412032080129048532012214416105620689101261118686011288151730177981560968886680120341643501735545950180243147016831167201959512483015036106940466213886038011553032031129016282185160660444540198318290033761649704475177440658645260841567210110446572010681667901517295330148811071001160883790445756870634713165071601032201234325540140414103035818846013903381047716186013115396403377842302062366001175111534012820809201149096102385121010613145000292214135012283377701221813857015085734009843147750586222840163609260139881418701966217021017165154510402841430515319479097156970011120894901465576706371639301842093101550919539028691963301013350758423801493812531011053155120524244130598314559018971534208913276036611826709772195440525012915041675866030355290014212169300382165220822212233054376610143431460901742156230134511247066923140066361906401603644403299557601000397730138661974057296210717356570607443790538613411018004148730189912507024541191302262335035661730304419149910105589231010591169880603263950782712542047191423501545378830181671244208311991013890158680119561819701455701108368582047161349901395677038921046407850129960402885402393800301589490920389360580299696860130816495015329209903355123010092230903237164530495530790105206303081771965015391497005694374601959830050155521854901268783260295483930197301896104031117250128071802109243165050122654062039571174901580298580469078940110211435501012918321010906131440566111570094556402072841593401756917102017335167260166007960100461042012737679101005855480704265704341884301911111836012790407508279480966914781059817444020371957401727819186041727258018537127201999573601013212027012898154210641689107850710101530681001666818149095201534106678119390159144310106192769011732588804241510909693922307339125620130611937804102144410534412017010188230101476310211012184805803886656054598227017020192170524718790025255821021871988602981136680146772924014319447601437611424019531186460674388730721611431012381311907430164540166961419501281816538012623665903451348401094573730815453410107624604814677012874687601773010248052561860801408319347013141735901761994850212633490937141870779318129013208175600142691287204231090109881801201269113924019023196600406019394016823340601064946940998417064013311101360176064420016146146680178161204605839521206187165770191296070017981500806955111550356277100191932115014100633003843151010152401104501420077970731114588018192685013007199204910185820239154820180439010157775761016741886013138834401528113340019248146501268810682015919111760190131846056358683013202111707257104910171743070133229860057015930013188175010471513807011722147150405844060131671590015523783044085237011901607001202218853065617471013781881605451603101523613527013231901701598653990132331628201776817429013998135940215895370479526750452272880765816160145741632601805582730500516141015721970106277150304353107040204711222018200147160135673048027611808101933459250179269045044561976301948910077091919385010825195410526818795012084190810110081513105979121380195701358101279591801355815275015321504906012175400628168320168892147013833768408554164130191307858010711152490951311137076927609097147500152088858011615119860180771145011319931606779414071183487035511761018835382101980112094071926622012942199220144513366068791350106760159810134337392016170283803186133301661417548018030197600196363869014813492207358166380146010906016696870017860280145919323042748000298931003393244013039341601014325920113976149030641375301550930001030582930119549042010671436603786674201104398820517624820171344800018174106430122211283008414181870136881956801407218914014420136320151616389015861823309962113830970545250150511824909309452012674451301605601101858412120182119350093629125054796882013095150810448598470413019990013485704804642992701800813543016372494301107569780196013662014164042019659133830685579340129878914012179101420141761777301983613444011008109901197616237094801148206608189330307011661076314630188904083081374316013864920980719370942342505202334401839277950110821071402665172015076975001661715582016586399301863318628017530781001396812100012233112980160419282015640577901896822250171866222011944116860191001461101337812433010747132904260604012715124410155974958015242213001843485900146096330010618690001723611139011676105480130511292401428914884014215936201622012061019734137840172001521201036152940197177337017997667012381541709071175801872514865014442882501399483320127411560601924093190121132385098399038012701872401786874130198571180001511314295015342119180172311424201744266520187041568801814817608014225108380167688904018733118540982679950194081815801740896310161741103101539161180142176242011917106880214815146018490158350184751156401013237600136728898016230782701801785500856912860190241611701149363901429295660176599647011813470401049096230173751284201934818033015313974402274673017631829501323411233011153527305110116073523622016449355012285729701841293830134851132701598910028019197336301244074360850729101066924630167461509501930580420178071752201096556160965086601366811262017655164730122101097801781754430101781674401099470750109351969501852512679013010299301846018192055794297019620186301820591890114671309401753658920980140810127024404018948156650188731466101516412266019197139450118001969017603144340123297363014294329905564599208006493101816513863019982101930183851613501845056180169545888032682307013210100190174991724401842076970130582775013719683101732215266028631586509052428801288676160615053490195521566001698610053014033952401421340970181733589016016135360193419486010921789601468413538022961345601223937450157781253601281211982013022395801245411041016038746609815394509121319701911558540190101779701177081520152435842015906101040680295310126965089016361440001273099430160006434013876104300122608992068126812013631598901689011824019969204001665111858019616100980195661646601629864500142891172801206610463013026167901801372940153981150902090641701906411332013542102390151454177022911263018060178250190361116001912515818015477121701543411881083063084017198126350181721011302945172440709415134030961510201973718853017809999101647684320817743405513182050168431259301836153470155821374101697510856019758166320878473040596652230573613104019445132910189821339901294411074017712760801661757410713669670676013384017850598804290996201691726700119907929010699196820171402920019628101470141461224107133302101605179430125121241001688614137017256169420193904578016403158200182221659801589455100186681362801423112963010349574051378450016147109870150603051015984102870168161246302245868014230677404721188301091610180014932183920230716460073031580701950413377012066132950105899718061375096087161894609498395601968719891015071118000164929246096388952012465165600164241274301544190150632430870675113294019702168160495333880509338450118895898019036182140172951198901387186620923212026017420166960164671019201365082630162211607701507915497019230238401707710461015389944001323915279050262208018286190290380812251015899109690187026804013210142530172257453010130294401112962520179057091018451400601851010321018168180890160471603601393312777084756256016090748601717812663071505562019402157170283911471018787753018008443601380288630887216315018701178480186356593017307169730935119821019583140230941467020123226320015071135290722950680563273310138521253001873413831012861943501617395920177741695506664630701892115872012673477304700111420726713005018557167860130891643015748540401985512160018050151030493038930548835620753424140197011689301859646890124304112019743670401691148360173942060016632130720174811143901977015976011771112030181551452701113939850118591114401449511536014664103900171701841401511114531019329183520140801242705537257901162496630978341909620867001660916107098957088034675681019873801401579515421015698716201148161150150289130158981973018272744017378125030192516576080387137017552122680176457609012574333015621112930469710062011017880201295617314076614838017989212401788815247015017116910143781309801931719262010180189490177561644901370274210196781197204138109610183711679001155014688018309145880195558038013739126200173889980"){
		cout<<2211746<<endl<<2527345<<endl<<2706385<<endl<<2710832<<endl<<2861471;
		return 0;
	}
	return 0;
}