#include<bits/stdc++.h>
#include<fstream>
using namespace std;int x=0,y=0,z=0;int a,b,c;int max =0;priority_queue<  pair  <  int  ,  pair<int,int>  >  > xxx;vector<int> each_club(4,0);vector<pair<pair<int,int>,int> > visit;int T; int n;vector<bool> visited(n+1,false);int main(){profile("club.in",'r',stdin);profile("club.out",'w',stdout);cin>>T;for(int i=0;i<T;i++){int max=0;cin>>n;for(int j=1;j<=n;j++){cin>>a>>b>>c;xxx.push({a,{j,1}});xxx.push({b,{j,2}});xxx.push({c,{j,3}});}while(!xxx.empty()){x=xxx.top().second.first;y=xxx.top().second.second;z=xxx.top().first;if(!visited[x] && each_club[y]<=(n/2)){max+=z;visited[x]=true;each_club[y]++;xxx.pop();}}for(int i=0;i<xxx.size();i++){x=xxx.top().second.first;y=xxx.top().second.second;z=xxx.top().first;if(!visited[x] && each_club[y]<=(2)){max+=z;visited[x]=true;each_club[y]++;xxx.pop();}}cout<<max;max=0;}return 0;}