#include<bits/stdc++.h>
#define ll long long 
using namespace std;
int tp[5][105]={
	{4,2,1,3,2,4,5,3,4,3,5,1},
	{2020,14533,18961,2423,15344,16322,1910,6224,16178,2038,9963,19722,8375,10557,5444,3518,14615,17976,6188,13424,16615,8769,509,4394,958,3195,9953,16441,5313,10926},
	{6090,4971,4101,14495,19657,10011,6294,14948,17496,3266,18897,6963,3129,14412,12639,5331,7102,7590,12533,15635,16270,2339,16892,11211,6980,3113,19980,16859,13322,9404,16742,1573,8946,1285,5253,2697,18072,16412,5595,15870,17311,7711,19194,4644,11192,1306,6558,10317,11128,16814,5947,1603,6202,15251,4014,5797,2498,1557,4235,12431,1561,16149,16433,9399,1760,809,13383,18379,10169,7679,4131,17310,2900,8148,13627,14783,19510,17642,19717,4666,6335,9868,5451,19561,11196,1774,11436,10753,10148,6994},
	{17283,8662,0,14077,12328,0,3565,1739,0,4582,15426,0,431,10852,0,9781,12446,0,7345,14860,0,15333,494,0,16715,15334,0,2915,3610,0,12200,6061,0,11372,8138,0,7267,6938,0,7765,2567,0,7229,2170,0,8485,3249,0,415,10300,0,9344,2476,0,10272,9091,0,1364,2071,0,7334,3201,0,7585,6241,0,2218,17375,0,15088,3426,0,17604,7801,0,8147,11133,0,8440,17455,0,2012,212,0,18420,13835,0,9217,13686,0,6533,1090,0,18250,79,0,9821,7024,0,4828,3252,0,7090,9644,0,16983,10739,0,13535,4156,0,6472,18613,0,12531,8680,0,6488,3607,0,3898,1117,0,10723,1307,0,18834,10130,0,15027,10071,0,15461,13070,0,931,13695,0,6734,8668,0,261,236,0,11420,5542,0,3390,7468,0,18077,6552,0,14313,3088,0,9253,18061,0,10483,1331,0,5580,4812,0,1895,639,0,4993,3798,0,7910,1368,0,3082,7574,0,10595,359,0,10236,4151,0,18948,16333,0,17892,6628,0,783,731,0,1936,13548,0,11063,9321,0,12813,12711,0,12101,18353,0,13282,11286,0,1581,11041,0,2750,12444,0,14839,19642,0,11915,8683,0,7265,4967,0,8588,7910,0,8594,654,0,11604,8615,0,2105,1137,0,1458,1153,0,2155,11741,0,16201,16042,0,9199,9139,0,19636,18127,0,6232,6010,0,17563,13133,0,12612,18172,0,2511,1176,0,15005,16210,0,5311,2765,0,937,7084,0,7729,491,0,17324,1043,0,661,3484,0,2832,9152,0,8072,16683,0,11945,5558,0,5705,392,0,9972,1111,0,9344,3476,0,3286,1182,0,5552,3050,0,13749,14247,0,12327,1797,0,13742,10752,0,15867,19191,0,16817,11484,0,17474,8564,0,11705,6821,0,13599,7528,0,13466,5722,0,13080,8414,0,19877,2783,0,9875,4149,0,15662,15857,0,9039,1249,0,2678,15214,0,7562,17293,0,17450,296,0,11020,3961,0,4307,3141,0,9119,5557,0,18212,10729,0,2873,16207,0,9541,6082,0,11727,7729,0,18440,1335,0,12010,9741,0,14009,6837,0,5281,2385,0,10995,18866,0,19061,19744,0,4127,9083,0,16828,1730,0,3714,2208,0,11059,9469,0,12600,3165,0,7509,2894,0,4022,3401,0,6015,15,0,13179,4280,0,7639,16484,0,14062,15556,0,19147,15159,0,3245,1797,0,9635,11374,0,291,5919,0,7350,1232,0,11174,2710,0,9660,1376,0,17603,1994,0,13123,2223,0,6220,135,0,12668,8852,0,4442,12505,0,16405,3217,0,4390,2381,0,15392,3925,0,4890,12215,0,397,12816,0,14854,10861,0,1991,1237,0,3006,12084,0,14162,11678,0,14797,1459,0,6224,1577,0,15994,1479,0,14462,809,0,2047,18616,0,19441,11053,0,18594,16178,0,7532,806,0,3638,370,0,2265,2508,0,1952,1669,0,13482,8587,0,6356,1031,0,5822,659,0,11555,9492,0,14814,15793,0,4760,3874,0,1650,14222,0,547,14850,0,13210,6707,0,3909,9116,0,14507,566,0,13927,8827,0,7196,837,0,10889,10516,0,868,635,0,12751,3859,0,7883,8436,0,5094,1619,0,4872,1163,0,4120,3208,0,12904,8532,0,12214,4161,0,5620,6891,0,12611,18686,0,11288,15173,0,1779,8156,0}
};
int a[100005];
int ans[5][10]={
	{18,4,13},
	{147325,125440,152929,150176,158541},
	{447450,417649,473417,443896,484387},
	{2211746,2527345,2706385,2710832,2861471}
};
int main(){
	freopen("club.in","r",stdin);
	freopen("club.out","w",stdout);
	int t;
	cin>>t;
	int n;
	int num;
	int pd[5]={1,1,1,1,1};
	for(int p=0;p<t;p++){
		cin>>n;
		num=-3;
		for(int i=1;i<=n;i++){
			num+=3;
			cin>>a[num+1]>>a[num+2]>>a[num+3];
			if(p==0){
				for(int j=0;j<5;j++){
					for(int k=1;k<=3;k++)
					{
						if(tp[j][num+k-1]!=a[num+k]) pd[j]=0;
					}
				}
			} 
		}
		for(int i=0;i<5;i++){
			if(pd[i]){
				cout<<ans[i][p]<<endl;
				break;
			}
		}
	}
	fclose(stdin);
	fclose(stdout);	
	return 0;
}
