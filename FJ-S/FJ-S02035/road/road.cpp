#include<bits/stdc++.h>
using namespace std;
#define fre(x) freopen(x".in","r",stdin),freopen(x".out","w",stdout) 
int n,m,k,f[12][10005],g[12],fa[10005];
struct node{
	int u,v;
	long long w;
}a[1000005];
bool cmp(node a,node b){
	return a.w<b.w;}
int find_set(int x){
	return fa[x]==x? x:fa[x]=find_set(fa[x]);}
signed main(){
	fre("road");
	ios::sync_with_stdio(false);
	cin.tie(0),cout.tie(0);
	cin>>n>>m>>k;
	for(int i=1;i<=m;i++)cin>>a[i].u>>a[i].v>>a[i].w;
	for(int i=1;i<=k;i++){
		cin>>g[i];
		for(int j=1;j<=n;j++)
			cin>>f[i][j];}
//	if(k==0){
		for(int i=1;i<=n;i++)fa[i]=i;
		sort(a+1,a+1+m,cmp);
		int cnt=0,ans=0;
		for(int i=1;i<=m;i++){
			if(cnt==n-1)break;
			int x=a[i].u,y=a[i].v;
			int fx=find_set(x),fy=find_set(y);
			if(fx==fy)continue;
			fa[fy]=fx;
			cnt++;
			ans+=a[i].w;}
		cout<<ans;
		exit(0);
//	}
	return 0;}
/*
CSP2025-S2RP+++++++++++++++++++++++++++++++++++++++++++++++++
CSP2025-S2RP+++++++++++++++++++++++++++++++++++++++++++++++++
CSP2025-S2RP+++++++++++++++++++++++++++++++++++++++++++++++++
CSP2025-S2RP+++++++++++++++++++++++++++++++++++++++++++++++++
CSP2025-S2RP+++++++++++++++++++++++++++++++++++++++++++++++++
CSP2025-S2RP+++++++++++++++++++++++++++++++++++++++++++++++++
CSP2025-S2RP+++++++++++++++++++++++++++++++++++++++++++++++++
CSP2025-S2RP+++++++++++++++++++++++++++++++++++++++++++++++++
CSP2025-S2RP+++++++++++++++++++++++++++++++++++++++++++++++++
CSP2025-S2RP+++++++++++++++++++++++++++++++++++++++++++++++++
CSP2025-S2RP+++++++++++++++++++++++++++++++++++++++++++++++++
CSP2025-S2RP+++++++++++++++++++++++++++++++++++++++++++++++++
CSP2025-S2RP+++++++++++++++++++++++++++++++++++++++++++++++++
CSP2025-S2RP+++++++++++++++++++++++++++++++++++++++++++++++++
CSP2025-S2RP+++++++++++++++++++++++++++++++++++++++++++++++++
CSP2025-S2RP+++++++++++++++++++++++++++++++++++++++++++++++++
CSP2025-S2RP+++++++++++++++++++++++++++++++++++++++++++++++++
CSP2025-S2RP+++++++++++++++++++++++++++++++++++++++++++++++++
*/
