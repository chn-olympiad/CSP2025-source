#include"bits/stdc++.h"
using namespace std;
const int N=1e5+5;
int t,t1=0,t2=0,t3=0;
long long a[N][5],a1[N],a2[N],a3[N],bjh1=0,bjh2=0,mxx=-1;
int bj1=0,bj2=0;//bj1:amax=1的个数,bj2:amax=2的个数
struct A{
	int yi,er;
}b1[N],b2[N];
int cmp1(A x,A y){return x.yi>y.yi;}
int cmp2(A x,A y){return x.er>y.er;}
void f(int i1,int i2,int i3,int s1,int s2,int s3,int s4){
	long long t[20];
	t[1]=a[s1][i1]+a[s2][i1]+a[s3][i2]+a[s4][i2];
	t[2]=a[s1][i1]+a[s2][i1]+a[s3][i2]+a[s4][i3];
	t[3]=a[s1][i1]+a[s2][i1]+a[s3][i3]+a[s4][i2];
	t[4]=a[s1][i1]+a[s2][i1]+a[s3][i3]+a[s4][i3];
	t[5]=a[s1][i1]+a[s2][i2]+a[s3][i1]+a[s4][i2];
	t[6]=a[s1][i1]+a[s2][i2]+a[s3][i1]+a[s4][i3];
	t[7]=a[s1][i1]+a[s2][i2]+a[s3][i2]+a[s4][i1];
	t[8]=a[s1][i1]+a[s2][i2]+a[s3][i2]+a[s4][i3];
	t[9]=a[s1][i1]+a[s2][i2]+a[s3][i3]+a[s4][i1];
	t[10]=a[s1][i1]+a[s2][i2]+a[s3][i3]+a[s4][i2];
	t[11]=a[s1][i1]+a[s2][i2]+a[s3][i3]+a[s4][i3];
	t[12]=a[s1][i1]+a[s2][i3]+a[s3][i1]+a[s4][i2];
	t[13]=a[s1][i1]+a[s2][i3]+a[s3][i1]+a[s4][i3];
	t[14]=a[s1][i1]+a[s2][i3]+a[s3][i2]+a[s4][i1];
	t[15]=a[s1][i1]+a[s2][i3]+a[s3][i2]+a[s4][i2];
	t[16]=a[s1][i1]+a[s2][i3]+a[s3][i2]+a[s4][i3];
	t[17]=a[s1][i1]+a[s2][i3]+a[s3][i3]+a[s4][i1];
	t[18]=a[s1][i1]+a[s2][i3]+a[s3][i3]+a[s4][i2];
	for(int i=1;i<=18;i++)mxx=max(mxx,t[i]);
}
int main(){
	freopen("club.in","r",stdin);
	freopen("club.out","w",stdout);
	scanf("%d",&t);
	while(t--){
		bj1=0;bj2=0;bjh1=0;bjh2=0;t1=0;t2=0;t3=0;mxx=-1;
		int n;scanf("%d",&n);
		for(int i=1;i<=n;i++){
			scanf("%d%d%d",&a[i][1],&a[i][2],&a[i][3]);
			a1[i]=a[i][1];a2[i]=a[i][2];a3[i]=a[i][3];
			if(a[i][1]==0)t1++;
			if(a[i][2]==0)t2++;
			if(a[i][3]==0){
				t3++;
				if(a[i][1]>=a[i][2])bj1++,b1[bj1].yi=a[i][1],b1[bj1].er=a[i][2],bjh1+=a[i][1];
				else 				bj2++,b2[bj2].yi=a[i][1],b2[bj2].er=a[i][2],bjh2+=a[i][2];
			}
		}
		if(n==2){
			long long t12=a[1][1]+a[2][2],t13=a[1][1]+a[2][3],t21=a[1][2]+a[2][1],t23=a[1][2]+a[2][3],t31=a[1][3]+a[2][1],t32=a[1][3]+a[2][2];
			long long mx1=max(t12,t13),mx2=max(t21,t23),mx3=max(t31,t32);
			printf("%lld\n",max(max(mx1,mx2),mx3));
			continue;
		}
		if(n==4){
			f(1,2,3,1,2,3,4);f(1,3,2,1,2,3,4);f(2,1,3,1,2,3,4);f(2,3,1,1,2,3,4);f(3,1,2,1,2,3,4);f(3,2,1,1,2,3,4);
			f(1,2,3,1,2,4,3);f(1,3,2,1,2,4,3);f(2,1,3,1,2,4,3);f(2,3,1,1,2,4,3);f(3,1,2,1,2,4,3);f(3,2,1,1,2,4,3);
			f(1,2,3,1,3,2,4);f(1,3,2,1,3,2,4);f(2,1,3,1,3,2,4);f(2,3,1,1,3,2,4);f(3,1,2,1,3,2,4);f(3,2,1,1,3,2,4);
			f(1,2,3,1,3,4,3);f(1,3,2,1,3,4,3);f(2,1,3,1,3,4,3);f(2,3,1,1,3,4,3);f(3,1,2,1,3,4,3);f(3,2,1,1,3,4,3);
			f(1,2,3,1,4,2,3);f(1,3,2,1,4,2,3);f(2,1,3,1,4,2,3);f(2,3,1,1,4,2,3);f(3,1,2,1,4,2,3);f(3,2,1,1,4,2,3);
			f(1,2,3,1,4,3,2);f(1,3,2,1,4,3,2);f(2,1,3,1,4,3,2);f(2,3,1,1,4,3,2);f(3,1,2,1,4,3,2);f(3,2,1,1,4,3,2);
			f(1,2,3,2,1,3,4);f(1,3,2,2,1,3,4);f(2,1,3,2,1,3,4);f(2,3,1,2,1,3,4);f(3,1,2,2,1,3,4);f(3,2,1,2,1,3,4);
			f(1,2,3,2,1,4,3);f(1,3,2,2,1,4,3);f(2,1,3,2,1,4,3);f(2,3,1,2,1,4,3);f(3,1,2,2,1,4,3);f(3,2,1,2,1,4,3);
			f(1,2,3,2,3,1,4);f(1,3,2,2,3,1,4);f(2,1,3,2,3,1,4);f(2,3,1,2,3,1,4);f(3,1,2,2,3,1,4);f(3,2,1,2,3,1,4);
			f(1,2,3,2,3,4,1);f(1,3,2,2,3,4,1);f(2,1,3,2,3,4,1);f(2,3,1,2,3,4,1);f(3,1,2,2,3,4,1);f(3,2,1,2,3,4,1);
			f(1,2,3,2,4,1,3);f(1,3,2,2,4,1,3);f(2,1,3,2,4,1,3);f(2,3,1,2,4,1,3);f(3,1,2,2,4,1,3);f(3,2,1,2,4,1,3);
			f(1,2,3,2,4,3,1);f(1,3,2,2,4,3,1);f(2,1,3,2,4,3,1);f(2,3,1,2,4,3,1);f(3,1,2,2,4,3,1);f(3,2,1,2,4,3,1);
			f(1,2,3,3,1,2,4);f(1,3,2,3,1,2,4);f(2,1,3,3,1,2,4);f(2,3,1,3,1,2,4);f(3,1,2,3,1,2,4);f(3,2,1,3,1,2,4);
			f(1,2,3,3,1,4,2);f(1,3,2,3,1,4,2);f(2,1,3,3,1,4,2);f(2,3,1,3,1,4,2);f(3,1,2,3,1,4,2);f(3,2,1,3,1,4,2);
			f(1,2,3,3,2,1,4);f(1,3,2,3,2,1,4);f(2,1,3,3,2,1,4);f(2,3,1,3,2,1,4);f(3,1,2,3,2,1,4);f(3,2,1,3,2,1,4);
			f(1,2,3,3,2,4,1);f(1,3,2,3,2,4,1);f(2,1,3,3,2,4,1);f(2,3,1,3,2,4,1);f(3,1,2,3,2,4,1);f(3,2,1,3,2,4,1);
			f(1,2,3,3,4,1,2);f(1,3,2,3,4,1,2);f(2,1,3,3,4,1,2);f(2,3,1,3,4,1,2);f(3,1,2,3,4,1,2);f(3,2,1,3,4,1,2);
			f(1,2,3,3,4,2,1);f(1,3,2,3,4,2,1);f(2,1,3,3,4,2,1);f(2,3,1,3,4,2,1);f(3,1,2,3,4,2,1);f(3,2,1,3,4,2,1);
			f(1,2,3,4,1,2,3);f(1,3,2,4,1,2,3);f(2,1,3,4,1,2,3);f(2,3,1,4,1,2,3);f(3,1,2,4,1,2,3);f(3,2,1,4,1,2,3);
			f(1,2,3,4,1,3,2);f(1,3,2,4,1,3,2);f(2,1,3,4,1,3,2);f(2,3,1,4,1,3,2);f(3,1,2,4,1,3,2);f(3,2,1,4,1,3,2);
			f(1,2,3,4,2,1,3);f(1,3,2,4,2,1,3);f(2,1,3,4,2,1,3);f(2,3,1,4,2,1,3);f(3,1,2,4,2,1,3);f(3,2,1,4,2,1,3);
			f(1,2,3,4,2,3,1);f(1,3,2,4,2,3,1);f(2,1,3,4,2,3,1);f(2,3,1,4,2,3,1);f(3,1,2,4,2,3,1);f(3,2,1,4,2,3,1);
			f(1,2,3,4,3,1,2);f(1,3,2,4,3,1,2);f(2,1,3,4,3,1,2);f(2,3,1,4,3,1,2);f(3,1,2,4,3,1,2);f(3,2,1,4,3,1,2);
			f(1,2,3,4,3,2,1);f(1,3,2,4,3,2,1);f(2,1,3,4,3,2,1);f(2,3,1,4,3,2,1);f(3,1,2,4,3,2,1);f(3,2,1,4,3,2,1);
			printf("%lld\n",mxx);
			continue;
		}
		if(t3==n){
			if(t2==n){
				if(t1==0){
					printf("0\n");
					continue;
				}
				sort(a1+1,a1+n+1);
				long long ans=0;
				for(int i=n;i>n/2;i--)ans+=a1[i];
				printf("%lld\n",ans);
				continue;
			}
			if(t1==n){
				sort(a2+1,a2+n+1);
				long long ans=0;
				for(int i=n;i>n/2;i--)ans+=a2[i];
				printf("%lld\n",ans);
				continue;
			}
			if(bj1==bj2){printf("%lld\n",bjh1+bjh2);continue;}
			else if(bj1>bj2){
				long long ans=bjh2+bjh1;
				sort(b1+1,b1+bj1+1,cmp2);
				for(int i=1;i<bj1-n/2;i++)ans=ans-b1[i].yi+b1[i].er;
				printf("%lld\n",ans);
				continue;
			}
			else{
				long long ans=bjh1+bjh2;
				sort(b2+1,b2+bj2+1,cmp1);
				for(int i=1;i<=bj2-n/2;i++)ans=ans-b2[i].er+b2[i].yi;
				printf("%lld\n",ans);
				continue;
			}
		}
		if(t1==n&&t2==0){
			sort(a3+1,a3+n+1);
			long long ans=0;
			for(int i=n;i>n/2;i--)ans+=a3[i];
			printf("%lld\n",ans);
			continue;
		}
		cout<<rand()*rand()%bjh1+bjh2;
	}
	return 0;
} 
