#include <bits/stdc++.h>
#define int long long
#define FAST ios::sync_with_stdio(0);cin.tie(0);cout.tie(0)
using namespace std;
/*
by qqqaaazzz

s[i] 表示这个人有没有放弃。

s[i] = 1，这里要填一个 > prv[0] 的数。
s[i] = 0，这里要么随便放，要么放一个 <= prv[0] 的数。

18 1
110111101110110101
6 0 4 2 1 2 5 4 3 3 4 5 3 6 4 7 3 6

18 1
100101011011010110
6 0 4 2 1 2 5 4 3 3 4 5 3 6 4 7 3 6

18 1
100101011011010110
6 0 4 2 1 2 5 4 3 3 4 5 3 6 4 7 3 6
946466965

18 18
111111111111111111
6 1 4 2 1 2 5 4 3 3 4 5 3 6 4 7 3 6

5 5
11111
1 2 3 1 2

3 1
101
1 0 2

4 1
1001
0 2 1 2
500 1
11011011010101111100111111111011100011011100111111111011110111100111111011111101001111010001110111011111110101010110100101011100101110101110111011101110110011110011111011010110100010011000111010011110101000101101101111111111101010101110111101101101111110111101110010000011111101111010010110011101011010110000010001111110101110101011011111101001111111101011010101110001111111101111101110111011101101100010100100001011111110110111001010010001011111000110001110100010111100110101001011011110010110111111
0 27 26 49 85 0 95 47 11 45 47 90 96 43 0 94 1 22 55 26 35 62 84 95 30 0 8 0 60 0 9 0 0 29 7 40 44 43 46 0 0 0 0 56 48 0 47 2 0 100 98 0 100 79 18 8 58 0 0 0 0 0 66 24 34 0 92 87 0 0 78 0 7 0 80 0 84 24 57 82 56 66 33 88 22 37 58 45 0 42 0 9 0 28 0 0 21 79 41 18 54 98 25 0 31 50 0 62 50 98 0 0 15 8 0 0 59 84 57 0 0 0 0 94 0 0 0 60 0 64 14 10 0 68 39 0 22 94 36 0 93 0 0 30 82 84 16 5 4 73 0 58 55 29 38 0 0 60 67 34 75 22 3 0 0 20 42 0 86 4 67 94 50 0 12 0 4 0 34 0 47 48 0 74 46 0 69 51 30 45 48 0 0 59 0 44 17 7 31 0 83 17 12 56 43 0 38 76 58 70 48 2 93 0 37 3 0 60 17 59 43 0 87 0 68 1 0 0 0 71 0 18 59 0 0 65 25 74 33 0 0 0 58 94 96 0 85 61 15 73 83 96 48 0 0 0 0 87 74 0 11 0 0 21 59 0 0 8 51 6 0 0 91 0 42 81 75 0 0 0 0 87 0 1 22 74 69 33 38 98 41 0 100 0 0 33 0 29 0 0 0 73 0 15 51 44 23 0 27 64 85 66 71 0 73 0 85 0 0 0 82 9 0 30 38 34 88 75 0 10 40 71 0 0 0 72 95 0 0 0 2 57 0 80 97 96 0 35 8 83 0 25 0 3 62 0 1 0 83 81 0 6 99 30 24 26 78 40 63 26 0 94 0 85 0 52 0 43 43 62 65 82 40 0 0 0 23 9 6 63 39 0 83 0 0 94 77 5 52 40 61 30 56 14 0 22 39 87 55 42 0 94 13 56 94 0 3 99 97 14 36 37 53 0 17 0 91 51 74 0 39 0 26 84 0 3 31 0 65 65 0 72 0 11 65 89 83 60 0 43 69 98 0 97 0 26 0 0 0 15 65 0 100 22 45 55 93 62 69 0 0 74 98 19 0 0 0 14 86 98 71 27 48 0 4 26 95 14 53 0 49 0 0 0 0 64 33 21 64 0

18 18
111111111111111111
6 1 1 2 1 2 5 4 3 3 4 5 3 6 4 7 3 6

10 5
1101111011
6 0 4 2 1 2 5 4 3 3

*/
int n,m;
char s[510];
int c[510];
const int p = 998244353;
int f[262144][20];//把这些人扔过去了，有多少放弃了？ 
int g[510][510];//g[i][j] 后 i 个有 j 个人自愿走到 1 上被虐
int qaq[510]; 

signed main()
{
	freopen("employ.in","r",stdin);
	freopen("employ.out","w",stdout);
	cin >> n >> m;
	for (int i=1;i<=n;i++) cin >> s[i];
	for (int i=1;i<=n;i++) cin >> c[i];
	if(n<=18){
		f[0][0] = 1;
		for (int i=0;i<(1<<n);i++){
			int C = 0;
			for (int j=0;j<n;j++) if((i>>j)&1) ++C;
			
			for (int j=0;j<=n;j++){
				for (int u=0;u<n;u++){
					if((i>>u)&1^1){
						f[i+(1<<u)][j+(s[C+1]=='0'||j>=c[u+1])] += f[i][j];
						f[i+(1<<u)][j+(s[C+1]=='0'||j>=c[u+1])] %= p;
					}
				}
			}
		}
		int final = 0;
		for (int i=m;i<=n;i++) final = (final+f[(1<<n)-1][n-i])%p;
		cout << final << "\n";
	}
	else if(m==1){
		//每一天都放弃了
		//每一个 1 都放一个 <i 的数
		int chu = 1;
		for (int i=1;i<=n;i++) chu = (chu*i)%p;
		sort(c+1,c+n+1);
		int cnt = 0;
		for (int i=1;i<=n;i++){
			if(s[i]=='1') ++cnt;
		}
		
		g[n+1][0] = 1;
		for (int i=n;i>=1;i--){
			//我可以被虐多少次？
			int my = 0;
			for (int h=1;h<=n;h++) if(s[h]=='1'&&h-1>=c[i]) ++my;
			for (int r=0;r<=cnt;r++){
				//这里占了 r 个 1
				g[i][r] = g[i+1][r];
				if(r&&my-(r-1)>=0) g[i][r] = (g[i][r]+g[i+1][r-1]*(my-(r-1)))%p;
			}
		}
		int qaq = 1;
		for (int i=1;i<=n-cnt;i++) qaq = (qaq*i)%p;
		int no = qaq*g[1][cnt]%p;
		cout << (chu-no+p)%p << "\n";
	}
	else if(m==n){
		//没有人放弃
		int chu = 1;
		for (int i=1;i<=n;i++) chu = (chu*i)%p;
		int op = 1;
		for (int i=1;i<=n;i++) if(s[i]=='0') op = 0;
		for (int i=1;i<=n;i++) if(c[i]==0) op = 0;
		cout << op*chu << "\n";
	}
	return 0;
}


