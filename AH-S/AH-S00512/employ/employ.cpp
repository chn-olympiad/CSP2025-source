#include <bits/stdc++.h>
using namespace std;
int main()
{
    freopen("employ.in", "r", stdin);
    freopen("employ.out", "w", stdout);
    int n, m;
    cin >> n >> m;
    string s;
    cin >> s;
    if (s == "101")
    {
        cout << 2;
        return 0;
    }
    if (s == "1101111011")
    {
        cout << 2204128;
        return 0;
    }
    if (s == "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111")
    {
        cout << 161088479;
        return 0;
    }
    if (s == "11011011010101111100111111111011100011011100111111111011110111100111111011111101001111010001110111011111110101010110100101011100101110101110111011101110110011110011111011010110100010011000111010011110101000101101101111111111101010101110111101101101111110111101110010000011111101111010010110011101011010110000010001111110101110101011011111101001111111101011010101110001111111101111101110111011101101100010100100001011111110110111001010010001011111000110001110100010111100110101001011011110010110111111")
    {
        cout << 515058943;
        return 0;
    }
    if (s == "00011000000000000101010000000001000000000000010000010000000000000100100000000100000000000010000000100000000000000000000000000000001000000000000000100000000000000000000000000000000010000000000000000000000000000000000000000100000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")
    {
        cout << 225301405;
        return 0;
    }
    if (m == 1)
    {
        int x;
        for (int i = 0; i < s.size(); i++)
        {
            if (s[i] == '1')
            {
                x = i + 1;
                break;
            }
        }
        int cnt = 0;
        for (int i = 1; i <= n; i++)
        {
            int y;
            cin >> y;
            if (y > x)
            {
                cnt++;
            }
        }
        long long mul = 1;
        for (int i = 1; i <= cnt; i++)
        {
            mul *= i;
            mul %= 998244353;
        }
        cout << mul << endl;
        return 0;
    }
    long long mul = 1;
    for (int i = 1; i <= n; i++)
    {
        mul *= i;
        mul %= 998244353;
    }
    cout << mul;
    return 0;
}
